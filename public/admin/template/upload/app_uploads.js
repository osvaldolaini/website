var UploadImage=function(){function e(e,a){var t=new FormData,s=new XMLHttpRequest;t.append("file",document.querySelector(".upload-file").files[e]),s.addEventListener("load",function(e){"success"==s.response.status?(a.querySelector(".text").innerHTML="<div><span>"+s.response.name+'</span><a style="cursor:pointer;color: #fff;" class="btn btn-secondary py-0 ml-1 btn-featured stars">Destaque <i class="fas fa-star"></i></a><input type="hidden" name="featured[]" value="0"><a style="cursor:pointer;color: #fff;" data-path="'+s.response.path+'" data-image="'+s.response.name+'" class="btn btn-info py-0 ml-1 text-white showImage">Visualizar <i class="fas fa-image" ></i></a><a style="cursor:pointer;color: #fff;" class="btn btn-danger py-0 ml-1 btn-delete-image text-white">Remover <i class="fas fa-trash-alt" ></i></a></div><input type="hidden" name="images[]" value="'+s.response.name+'">',a.classList.add("complete")):(a.querySelector(".text").innerHTML="Erro ao enviar: "+s.response.name,a.classList.add("error"))}),s.upload.addEventListener("progress",function(e){var t=e.loaded/e.total*100;a.querySelector(".fill").style.minWidth=t+"%"}),s.responseType="json",s.open("post",APP_URL+"/uploads"),console.log(APP_URL),console.log(CSRF_TOKEN),s.setRequestHeader("x-csrf-token",CSRF_TOKEN),s.send(t)}return{init:function(){$(document).on("dragenter",".area-upload",function(){$(".area-upload .label-upload").addClass("highlight")}),$(document).on("dragleave drop",".area-upload",function(){$(".area-upload .label-upload").removeClass("highlight")}),$(document).on("change",".upload-file",function(){for(var a,t=this.files,s=0;s<t.length;s++){var n=(a=t[s],-1==["image/jpeg","image/png","image/jpeg","image/webp"].indexOf(a.type)?{error:"O arquivo "+a.name+" nÃ£o permitido"}:a.size>2097152?{error:a.name+" ultrapassou limite de 2MB"}:{success:"Enviando: "+a.name}),o=document.createElement("div"),d=document.createElement("div"),i=document.createElement("div");o.appendChild(d),o.appendChild(i),o.classList.add("barra"),d.classList.add("fill"),i.classList.add("text"),null==n.error?(i.innerHTML=n.success,e(s,o)):(i.innerHTML=n.error,o.classList.add("error")),document.querySelector(".lista-uploads").appendChild(o)}}),$(document).on("click",".showImage",function(){let e=$(this).data("path"),a=$(this).data("image");$("body").append('<div class="modal fade" id="imagesModel"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5>'+a+'</h5><button type="button" class="close removeModal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"></div></div></div></div>'),$("#imagesModel .modal-body").append('<img src="'+e+"/"+a+'" class="w-50 mx-auto d-block">'),$("#imagesModel").modal({shown:!0})}),$(document).on("click",".removeModal",function(){$("#imagesModel").modal({hide:!0}),$("#imagesModel").modal({hide:!0})&&$("#imagesModel img").remove()}),$(document).on("click",".btn-featured",function(){$('[name="featured[]"]').val("0"),$(this).parent().children().val("1"),$(".stars").removeClass("btn-warning"),$(".stars").addClass("btn-secondary"),$(this).removeClass("btn-secondary"),$(this).addClass("btn-warning")}),$(document).on("click",".btn-delete-image",function(){$(this).parent().parent().parent().remove()})}}}();jQuery(document).ready(function(){UploadImage.init()});
